Here are the updates I made to the original nightly_scanner.py script to get it running correctly:

  1. Corrected Time Series Data Shape for STUMPY

   * Problem: The script was failing with a ValueError from the stumpy.stump() function, indicating an issue with the input data's dimensions.
     STUMPY's core functions require a 1-dimensional NumPy array (a flat list of numbers), but the data from yfinance can sometimes have a more
     complex structure.
   * Fix: I modified the call to stumpy.stump() to explicitly flatten the time series data.
       * Original Code: mp, I = stumpy.stump(ts, m=m_window_size)
       * Updated Code: mp_output = stumpy.stump(ts.flatten(), m=m_window_size)

  2. Handled the Output of stumpy.stump()

   * Problem: The script was initially written assuming stumpy.stump() returns two separate variables (mp and I). However, it returns a single
     NumPy array where the first column is the Matrix Profile and the second column contains the Profile Indices. This caused a ValueError: too
     many values to unpack.
   * Fix: I changed the code to accept the single output array and then correctly slice it to get the mp (Matrix Profile) and I (Profile
     Indices) values.
       * Original Code: mp, I = stumpy.stump(...)
       * Updated Code:

   1         mp_output = stumpy.stump(...)
   2         mp = mp_output[:, 0]
   3         I = mp_output[:, 1]

  3. Corrected the CAC Function Call

   * Problem: The script was calling stumpy.floss(), but the arguments being passed were incorrect, leading to a TypeError. The intended
     function for this type of regime change analysis in recent versions of STUMPY is stumpy.fluss().
   * Fix: I replaced the incorrect function call with the correct one.
       * Original Code: cac = stumpy.floss(I, m=m_window_size)
       * Updated Code: cac, _ = stumpy.fluss(I, L=m_window_size, n_regimes=2)

  4. Added Missing n_regimes Argument

   * Problem: After correcting the function name to stumpy.fluss(), the script failed again with a TypeError because a required argument,
     n_regimes, was missing. This argument tells the function how many distinct regimes to look for (in our case, two: "before" and "after" the
     change).
   * Fix: I added the n_regimes=2 argument to the stumpy.fluss() call, satisfying the function's requirements.
       * Original Code: cac, _ = stumpy.fluss(I, L=m_window_size)
       * Updated Code: cac, _ = stumpy.fluss(I, L=m_window_size, n_regimes=2)

  These four changes resolved the errors and allowed the nightly_scanner.py script to execute successfully.
